import requests
import time

# Twitter API credentials
BEARER_TOKEN = 'your_bearer_token'  # Use bearer token for v2

# Discord webhook URL
DISCORD_WEBHOOK_URL = 'your_discord_webhook_url'

# Username to track
username = 'target_username'  # Replace with the target username

# Keep track of the latest tweet ID
last_tweet_id = None

def get_user_id(username):
    url = f'https://api.twitter.com/2/users/by/username/{username}'
    headers = {"Authorization": f"Bearer {BEARER_TOKEN}"}
    response = requests.get(url, headers=headers)
    return response.json()['data']['id']

user_id = get_user_id(username)

while True:
    try:
        url = f'https://api.twitter.com/2/users/{user_id}/tweets'
        headers = {"Authorization": f"Bearer {BEARER_TOKEN}"}
        response = requests.get(url, headers=headers)
        tweets = response.json().get('data', [])

        for tweet in tweets:
            if last_tweet_id is None or tweet['id'] > last_tweet_id:
                message = f"New tweet from @{username}: {tweet['text']}"
                print(message)  # Print to console for debugging

                # Send the message to Discord
                requests.post(DISCORD_WEBHOOK_URL, json={"content": message})

                # Update the last tweet ID
                last_tweet_id = tweet['id']

        time.sleep(60)  # Wait before checking again

    except Exception as e:
        print(f"An error occurred: {e}")
        time.sleep(60)  # Wait before retrying in case of error

